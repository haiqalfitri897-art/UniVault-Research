name: Deploy to Production

on:
  push:
    branches: [ main ]

jobs:
  deploy-backend:
    runs-on: ubuntu-latest
    if: github.event_name == 'push' && github.ref == 'refs/heads/main'
    
    steps:
    - uses: actions/checkout@v3
    
    - name: Deploy Backend to Railway
      env:
        RAILWAY_TOKEN: ${{ secrets.RAILWAY_TOKEN }}
      run: |
        # Install Railway CLI
        npm install -g @railway/cli
        
        # Deploy using Railway
        railway up \
          --service backend \
          --token $RAILWAY_TOKEN
      
      # Note: You'll need to:
      # 1. Get your RAILWAY_TOKEN from Railway dashboard
      # 2. Add it as a GitHub secret: Settings > Secrets and variables > Actions
      # 3. Uncomment this job when ready to deploy

    # Alternative: Deploy to Render
    # - name: Deploy Backend to Render
    #   env:
    #     RENDER_DEPLOY_HOOK: ${{ secrets.RENDER_DEPLOY_HOOK }}
    #   run: |
    #     curl -X POST $RENDER_DEPLOY_HOOK

  deploy-frontend:
    runs-on: ubuntu-latest
    if: github.event_name == 'push' && github.ref == 'refs/heads/main'
    
    steps:
    - uses: actions/checkout@v3
    
    - name: Build Frontend
      run: |
        cd frontend
        npm install
        npm run build
    
    - name: Deploy to Vercel
      env:
        VERCEL_TOKEN: ${{ secrets.VERCEL_TOKEN }}
      run: |
        npm install -g vercel
        vercel --prod --token=$VERCEL_TOKEN
      
      # Note: You'll need to:
      # 1. Get your VERCEL_TOKEN from Vercel account settings
      # 2. Add it as a GitHub secret
      # 3. Add vercel.json configuration file
      # 4. Uncomment this job when ready to deploy

    # Alternative: Deploy to Netlify
    # - name: Deploy to Netlify
    #   env:
    #     NETLIFY_SITE_ID: ${{ secrets.NETLIFY_SITE_ID }}
    #     NETLIFY_AUTH_TOKEN: ${{ secrets.NETLIFY_AUTH_TOKEN }}
    #   run: |
    #     npm install -g netlify-cli
    #     netlify deploy --prod --dir=frontend/dist
